# Homework 6: City Generation

[DEMO](https://lanlou123.github.io/hw06-city-generation/)
## current progress : building generation
![](./cur.JPG)
## Features:
- **Acceleration structure** , I have been bothered by the performance issue caused by checking every branch in the scene when doing intersection and conjunction checking, with the increasing number of branches generated by turtle, this could be a really heavy burden, then I realized that such large amount of checking is not neccessary at all, recall from the first assaingment in GPU programming course, I only need to check a sorounding area within certain range by using a grid structure, the index of the grid cells will be corresponding to the current position of the checking point, and each time I'm generating a branch(road or highway) I will push this road into a corresponding road array inside a 2-Dimensional array storing the road arrays. therefore in the future when doing the checking, the time complexity is greatly decreased since I will only be checking ```roadnum/numcells```instead of ```roadnum```, the performancce boost is really helpful for me to add more road related building features which I will describe later.
- **Rasterize the Map of road and water**: instead of rasterize these stuff on CPU, I chosed to use Framebuffer and texture to acheive this, there will be in general three passes, first pass, do the instanced rendering of road(a bunch of quad) render to road texture by framebuffer, second pass, render the elevation texture(water information), third pass take in two above texture and combine them in fragment shader, then write to CPU by readpixels for furture use
- **Building generation**: first generate a 100X100 grid extending the entire scene, then foreach cell in the grid generate a random point in it, then use the rasterized buffer from the previous step to determine if we place building here or not, if decided to place one, then record the translation information as mat4

![](./p2.JPG)
- **Road sensitive buildings**: as can be noticed from the image above, the shape of the building is affected by roads in several aspects: the building is aligning with the heading of the road around it, and is resized depending on the size of the block it is in
  - Size of the building, here is when the acceleration structure I mentioned above come in handy, each of the building points will try to get a closest point to another road in the acceleration cell, and the closest point will be the restriction of the current building, this information will again be recorded as mat4(scale)
  - Orientation of the building : similarily, we check the closest point, this time we will get the owner road of the point, and get the orientation of that road, and use a quaternion to initilize the rotation matrix...






